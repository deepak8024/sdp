#include <iostream>

#include <SDL2/SDL.h>
#include <SDL2/SDL_image.h>

#include "renderTexture.h"

const int sw = 640;
const int sh = 480;


renderTexture window;


bool loadMedia();

bool loadMedia() {
    int success = true;
    if(!window.loadFromFile("arrow.png")) {
        std::cout << "unable to load image color.png " << SDL_GetError() << "\n";
        success = false;
    }
    return success;
}

int main() {
    if(!window.init("HAHA", sw, sh)) {
        std::cout << "initialization failed" << "\n";
    }
    else {
        if(!loadMedia()) {
            std::cout << "unable to load media " << "\n";
        }
        else {
            bool isRunning = true;
            SDL_Event ev;
            int frame = 0;
            SDL_RendererFlip flipType = SDL_FLIP_NONE;
            double degrees = 0;
            int texW = window.getTexW(), texH = window.getTexH();

            while(isRunning) {
                while(SDL_PollEvent(&ev) != 0) {
                    if(ev.type == SDL_QUIT) {
                        isRunning = false;
                    }
                    else if(ev.type == SDL_KEYDOWN) {
                        switch(ev.key.keysym.sym) {
                            case SDLK_a:
                                degrees += 30;
                                break;
                            case SDLK_d:
                                degrees -= 30;
                                break;
                            case SDLK_n:
                                flipType = SDL_FLIP_NONE;
                                break;
                            case SDLK_h:
                                flipType = SDL_FLIP_HORIZONTAL;
                                break;
                            case SDLK_v:
                                flipType = SDL_FLIP_VERTICAL;
                                break;
                        }
                    }
                }
                window.clear();

                window.render((sw-texW)/2, (sh-texH)/2, degrees, NULL, flipType);
                window.display();

                }
            }
        }

    window.close();
    return 0;
}

